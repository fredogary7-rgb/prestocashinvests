{% extends "layout.html" %}
{% block title %}Demande de Retrait{% endblock %}

{% block content %}
<div class="max-w-xl mx-auto bg-white p-8 rounded-2xl shadow-2xl border-t-4 border-yellow-500
            transform transition-all duration-700 ease-out opacity-0 translate-y-10 animate-fadeIn
            hover:shadow-yellow-200/70 hover:-translate-y-1">

    <h2 class="text-3xl font-extrabold text-gray-900 mb-8 text-center tracking-wide animate-slideDown">
        ðŸ’³ Demande de Retrait
    </h2>

    <!-- Solde Disponible pour retrait -->
    <div class="bg-gradient-to-r from-yellow-100 to-yellow-50 border-l-4 border-yellow-500 text-gray-800 p-5 mb-4 rounded-xl
                transform transition-all duration-500 hover:scale-[1.03] hover:shadow-md animate-popIn">
        <p class="font-semibold text-lg mb-1">Solde Disponible pour Retrait :</p>
        <p class="text-3xl font-extrabold text-yellow-600">
            {{ "{:,.2f}".format(withdrawable_balance) | replace(",", " ") }} XOF
        </p>
    </div>

    <form method="POST" action="{{ url_for('process_retrait') }}" class="space-y-6 animate-fadeSlideUp">
        <!-- Pays -->
        <div>
            <label for="country" class="block text-sm font-medium text-gray-700 mb-2">Pays</label>
            <select id="country" name="country" required
                    class="w-full px-5 py-3 border border-gray-200 rounded-xl shadow-sm focus:ring-yellow-500 focus:border-yellow-500
                           transition-all duration-300 transform hover:scale-[1.01] bg-gray-50">
                <option value="">SÃ©lectionner un pays</option>
                <option value="Benin">BÃ©nin</option>
                <option value="Togo">Togo</option>
                <option value="Burkina Faso">Burkina Faso</option>
                <option value="Cameroun">Cameroun</option>
                <option value="SÃ©nÃ©gal">SÃ©nÃ©gal</option>
                <option value="Mali">Mali</option>
                <option value="Gabon">Gabon</option>
                <option value="CÃ´te d'Ivoire">CÃ´te d'Ivoire</option>
                <option value="Ouganda">Ouganda</option>
                <option value="RD Congo">RD Congo</option>
                <option value="Zambie">Zambie</option>
            </select>
        </div>

        <!-- MÃ©thode de paiement -->
        <div>
            <label for="method" class="block text-sm font-medium text-gray-700 mb-2">MÃ©thode de Retrait</label>
            <select id="method" name="method" required
                    class="w-full px-5 py-3 border border-gray-200 rounded-xl shadow-sm focus:ring-yellow-500 focus:border-yellow-500
                           transition-all duration-300 transform hover:scale-[1.01] bg-gray-50">
                <option value="">SÃ©lectionner une mÃ©thode</option>
                <option value="Moov Money">Moov Money</option>
                <option value="MTN Money">MTN</option>
                <option value="Orange Money">Orange Money</option>
                <option value="Mix by YAS">Mix by YAS</option>
                <option value="Crypto BEP20">Crypto BEP20</option>
                <option value="Airtel Money">Airtel</option>
                <option value="Vodacom Money">Vodacom</option>
            </select>
        </div>

        <!-- NumÃ©ro Mobile ou Adresse Crypto -->
        <div>
            <label for="address_or_number" class="block text-sm font-medium text-gray-700 mb-2">
                NumÃ©ro Mobile ou Adresse Crypto
            </label>

            <input type="text" id="address_or_number" name="address_or_number"
                   value="{{ user.withdrawal_number if user.withdrawal_number else '' }}"
                   placeholder="Entrez votre numÃ©ro ou adresse"
                   required
                   class="w-full px-5 py-3 border border-gray-200 rounded-xl shadow-sm focus:ring-yellow-500 focus:border-yellow-500
                          transition-all duration-300 transform hover:scale-[1.01] bg-gray-50"
                   {% if user.withdrawal_number %}readonly{% endif %}>

            {% if user.withdrawal_number %}
            <button type="button"
                    onclick="enableEdit()"
                    class="mt-2 text-sm text-blue-600 underline hover:text-blue-800 transition-all duration-300 hover:scale-[1.05]">
                Modifier mon numÃ©ro de retrait
            </button>
            {% endif %}
        </div>

        <!-- Montant -->
        <div>
            <label for="amount" class="block text-sm font-medium text-gray-700 mb-2">Montant Ã  Retirer</label>
            <p class="text-sm text-gray-600 mb-2">
                Montant maximum autorisÃ© : {{ "{:,.2f}".format(withdrawable_balance) | replace(",", " ") }} XOF
            </p>
            <input type="number" step="0.01" id="amount" name="amount" required
                   placeholder="Ex: 1500.00"
                   min="1500" max="{{ withdrawable_balance }}"
                   class="w-full px-5 py-3 border border-gray-200 rounded-xl shadow-sm focus:ring-yellow-500 focus:border-yellow-500
                          transition-all duration-300 transform hover:scale-[1.01] bg-gray-50">
        </div>

        <!-- Bouton -->
        <div class="pt-2">
            <button type="submit"
                    class="w-full bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600
                           text-gray-900 font-bold py-3 px-6 rounded-xl shadow-lg
                           transition-all duration-300 transform hover:scale-[1.04] hover:shadow-yellow-300/60 active:scale-[0.98]">
                ðŸš€ Soumettre le Retrait
            </button>
        </div>
    </form>
</div>

<!-- Animations personnalisÃ©es -->
<style>
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(25px); }
    to { opacity: 1; transform: translateY(0); opacity: 1; }
}
@keyframes slideDown {
    from { opacity: 0; transform: translateY(-30px); }
    to { opacity: 1; transform: translateY(0); }
}
@keyframes popIn {
    from { transform: scale(0.95); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
}
@keyframes fadeSlideUp {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
}
.animate-fadeIn { animation: fadeIn 0.7s ease-out forwards; }
.animate-slideDown { animation: slideDown 0.8s ease-out forwards; }
.animate-popIn { animation: popIn 0.6s ease-out forwards; }
.animate-fadeSlideUp { animation: fadeSlideUp 0.7s ease-out forwards; }
</style>

<script>
function enableEdit() {
    const input = document.getElementById('address_or_number');
    input.removeAttribute('readonly');
    input.classList.add("bg-white", "border-yellow-400");
    input.focus();
}
</script>
{% endblock %}
